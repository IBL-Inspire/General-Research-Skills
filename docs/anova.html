<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 ANOVA | General Research Skills</title>
  <meta name="description" content="Chapter 6 ANOVA | General Research Skills" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 ANOVA | General Research Skills" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 ANOVA | General Research Skills" />
  
  
  

<meta name="author" content="Dr. F.J. Rodenburg &amp; Dr. H.G.J. van Mil   © 2020–2022 Universiteit Leiden" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="study-design.html"/>
<link rel="next" href="simple-linear-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">General Research Skills</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#previous-cohorts"><i class="fa fa-check"></i>Previous Cohorts</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="installation-tutorial.html"><a href="installation-tutorial.html"><i class="fa fa-check"></i><b>1</b> Installation &amp; Tutorial</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installation-tutorial.html"><a href="installation-tutorial.html#installation-guide"><i class="fa fa-check"></i><b>1.1</b> Installation Guide</a>
<ul>
<li class="chapter" data-level="" data-path="installation-tutorial.html"><a href="installation-tutorial.html#note-about-installation-problems"><i class="fa fa-check"></i>Note about installation problems</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installation-tutorial.html"><a href="installation-tutorial.html#about-rstudio-r-markdown"><i class="fa fa-check"></i><b>1.2</b> About RStudio &amp; R Markdown</a></li>
<li class="chapter" data-level="1.3" data-path="installation-tutorial.html"><a href="installation-tutorial.html#about-the-r-language"><i class="fa fa-check"></i><b>1.3</b> About the R Language</a></li>
<li class="chapter" data-level="1.4" data-path="installation-tutorial.html"><a href="installation-tutorial.html#tutorials"><i class="fa fa-check"></i><b>1.4</b> Tutorials</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="installation-tutorial.html"><a href="installation-tutorial.html#exercise-swirl"><i class="fa fa-check"></i><b>1.4.1</b> Exercise: <code>swirl</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="installation-tutorial.html"><a href="installation-tutorial.html#exercise-learnr-optional"><i class="fa fa-check"></i><b>1.4.2</b> Exercise <code>learnr</code> (optional)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="random-variables.html"><a href="random-variables.html"><i class="fa fa-check"></i><b>2</b> Random Variables</a>
<ul>
<li class="chapter" data-level="2.1" data-path="random-variables.html"><a href="random-variables.html#what-are-random-variables"><i class="fa fa-check"></i><b>2.1</b> What are Random Variables?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="random-variables.html"><a href="random-variables.html#exercise"><i class="fa fa-check"></i><b>2.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="random-variables.html"><a href="random-variables.html#degrees-of-freedom"><i class="fa fa-check"></i><b>2.2</b> Degrees of Freedom</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="random-variables.html"><a href="random-variables.html#exercises"><i class="fa fa-check"></i><b>2.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="random-variables.html"><a href="random-variables.html#probability-distributions"><i class="fa fa-check"></i><b>2.3</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="random-variables.html"><a href="random-variables.html#exercises-1"><i class="fa fa-check"></i><b>2.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>3</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistics-test-statistics-hypothesis-tests"><i class="fa fa-check"></i><b>3.2</b> Statistics, test-statistics &amp; hypothesis tests</a></li>
<li class="chapter" data-level="3.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test-step-by-step"><i class="fa fa-check"></i><b>3.3</b> One sample t-test: step by step</a></li>
<li class="chapter" data-level="3.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#assumptions"><i class="fa fa-check"></i><b>3.4</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>4</b> Statistical Tests</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistical-tests.html"><a href="statistical-tests.html#t-test"><i class="fa fa-check"></i><b>4.1</b> T-Test</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistical-tests.html"><a href="statistical-tests.html#choosing-the-right-t-test"><i class="fa fa-check"></i><b>4.1.1</b> Choosing the right <span class="math inline">\(t\)</span>-test</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistical-tests.html"><a href="statistical-tests.html#exercises-2"><i class="fa fa-check"></i><b>4.1.2</b> Exercises</a></li>
<li class="chapter" data-level="4.1.3" data-path="statistical-tests.html"><a href="statistical-tests.html#understanding-how-the-t-test-works"><i class="fa fa-check"></i><b>4.1.3</b> Understanding how the <span class="math inline">\(t\)</span>-test works</a></li>
<li class="chapter" data-level="4.1.4" data-path="statistical-tests.html"><a href="statistical-tests.html#exercises-3"><i class="fa fa-check"></i><b>4.1.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistical-tests.html"><a href="statistical-tests.html#chi-squared-test"><i class="fa fa-check"></i><b>4.2</b> Chi-Squared Test</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistical-tests.html"><a href="statistical-tests.html#lecture"><i class="fa fa-check"></i><b>4.2.1</b> Lecture</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistical-tests.html"><a href="statistical-tests.html#exercises-4"><i class="fa fa-check"></i><b>4.2.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistical-tests.html"><a href="statistical-tests.html#multiple-testing"><i class="fa fa-check"></i><b>4.3</b> Multiple Testing</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistical-tests.html"><a href="statistical-tests.html#lecture-1"><i class="fa fa-check"></i><b>4.3.1</b> Lecture</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistical-tests.html"><a href="statistical-tests.html#exercises-5"><i class="fa fa-check"></i><b>4.3.2</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="study-design.html"><a href="study-design.html"><i class="fa fa-check"></i><b>5</b> Study Design</a>
<ul>
<li class="chapter" data-level="5.1" data-path="study-design.html"><a href="study-design.html#lecture-2"><i class="fa fa-check"></i><b>5.1</b> Lecture</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>6</b> ANOVA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="anova.html"><a href="anova.html#overview"><i class="fa fa-check"></i><b>6.1</b> Overview</a>
<ul>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#summary-of-the-example-in-the-video"><i class="fa fa-check"></i>Summary of the example in the video</a></li>
<li class="chapter" data-level="6.1.1" data-path="anova.html"><a href="anova.html#exercises-6"><i class="fa fa-check"></i><b>6.1.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="anova.html"><a href="anova.html#how-does-anova-work"><i class="fa fa-check"></i><b>6.2</b> How does ANOVA work?</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="anova.html"><a href="anova.html#exercises-7"><i class="fa fa-check"></i><b>6.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="anova.html"><a href="anova.html#two-way-multi-way-interaction"><i class="fa fa-check"></i><b>6.3</b> Two-Way, Multi-Way &amp; Interaction</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="anova.html"><a href="anova.html#exercises-8"><i class="fa fa-check"></i><b>6.3.1</b> Exercises</a></li>
<li class="chapter" data-level="6.3.2" data-path="anova.html"><a href="anova.html#additional-exercises"><i class="fa fa-check"></i><b>6.3.2</b> Additional Exercises (*)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="anova.html"><a href="anova.html#where-is-part-4"><i class="fa fa-check"></i><b>6.4</b> Where is part 4? (*)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>7</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#overview-1"><i class="fa fa-check"></i><b>7.1</b> Overview</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#LMsummary"><i class="fa fa-check"></i><b>7.1.1</b> Summary of the example in the video</a></li>
<li class="chapter" data-level="7.1.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercises-9"><i class="fa fa-check"></i><b>7.1.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#step-by-step-walkthrough"><i class="fa fa-check"></i><b>7.2</b> Step-by-Step Walkthrough</a></li>
<li class="chapter" data-level="7.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>7.3</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercises-10"><i class="fa fa-check"></i><b>7.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#transformation"><i class="fa fa-check"></i><b>7.4</b> Transformation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="factorial-anova.html"><a href="factorial-anova.html"><i class="fa fa-check"></i><b>8</b> Factorial ANOVA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="factorial-anova.html"><a href="factorial-anova.html#interaction"><i class="fa fa-check"></i><b>8.1</b> Interaction</a></li>
<li class="chapter" data-level="8.2" data-path="factorial-anova.html"><a href="factorial-anova.html#three-example-factorial-anova-data-sets"><i class="fa fa-check"></i><b>8.2</b> Three example factorial ANOVA data sets</a></li>
<li class="chapter" data-level="8.3" data-path="factorial-anova.html"><a href="factorial-anova.html#model-specification-and-diagnostics"><i class="fa fa-check"></i><b>8.3</b> Model specification and diagnostics</a></li>
<li class="chapter" data-level="8.4" data-path="factorial-anova.html"><a href="factorial-anova.html#model-selection"><i class="fa fa-check"></i><b>8.4</b> Model selection</a></li>
<li class="chapter" data-level="8.5" data-path="factorial-anova.html"><a href="factorial-anova.html#some-final-thoughts-and-visualisation"><i class="fa fa-check"></i><b>8.5</b> Some final thoughts and visualisation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ancova-model-selection.html"><a href="ancova-model-selection.html"><i class="fa fa-check"></i><b>9</b> ANCOVA &amp; Model Selection</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ancova-model-selection.html"><a href="ancova-model-selection.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="ancova-model-selection.html"><a href="ancova-model-selection.html#the-ancova-explained-by-simulations"><i class="fa fa-check"></i><b>9.2</b> The ANCOVA explained by simulations</a></li>
<li class="chapter" data-level="9.3" data-path="ancova-model-selection.html"><a href="ancova-model-selection.html#the-analysis-of-ancova-data-step-by-step"><i class="fa fa-check"></i><b>9.3</b> The analysis of ANCOVA data step by step</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="ancova-model-selection.html"><a href="ancova-model-selection.html#exercises-11"><i class="fa fa-check"></i><b>9.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="ancova-model-selection.html"><a href="ancova-model-selection.html#model-selection-1"><i class="fa fa-check"></i><b>9.4</b> Model Selection</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="ancova-model-selection.html"><a href="ancova-model-selection.html#exercises-12"><i class="fa fa-check"></i><b>9.4.1</b> Exercises</a></li>
<li class="chapter" data-level="9.4.2" data-path="ancova-model-selection.html"><a href="ancova-model-selection.html#exercises-hard"><i class="fa fa-check"></i><b>9.4.2</b> Exercises (hard)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>10</b> PCA</a>
<ul>
<li class="chapter" data-level="10.1" data-path="pca.html"><a href="pca.html#introduction-2"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="pca.html"><a href="pca.html#motivation-behind-pca"><i class="fa fa-check"></i><b>10.2</b> Motivation behind PCA</a></li>
<li class="chapter" data-level="10.3" data-path="pca.html"><a href="pca.html#pca-fundamentals"><i class="fa fa-check"></i><b>10.3</b> PCA fundamentals</a></li>
<li class="chapter" data-level="10.4" data-path="pca.html"><a href="pca.html#pca-in-classification"><i class="fa fa-check"></i><b>10.4</b> PCA in classification</a></li>
<li class="chapter" data-level="10.5" data-path="pca.html"><a href="pca.html#pca-and-gradients"><i class="fa fa-check"></i><b>10.5</b> PCA and gradients</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="pca.html"><a href="pca.html#exercises-13"><i class="fa fa-check"></i><b>10.5.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bioinformatics-workshop.html"><a href="bioinformatics-workshop.html"><i class="fa fa-check"></i><b>11</b> Bioinformatics Workshop</a>
<ul>
<li class="chapter" data-level="11.1" data-path="bioinformatics-workshop.html"><a href="bioinformatics-workshop.html#preparation"><i class="fa fa-check"></i><b>11.1</b> Preparation</a></li>
<li class="chapter" data-level="11.2" data-path="bioinformatics-workshop.html"><a href="bioinformatics-workshop.html#rnaseq"><i class="fa fa-check"></i><b>11.2</b> RNAseq</a></li>
<li class="chapter" data-level="11.3" data-path="bioinformatics-workshop.html"><a href="bioinformatics-workshop.html#exercises-14"><i class="fa fa-check"></i><b>11.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>12</b> GLM</a>
<ul>
<li class="chapter" data-level="12.1" data-path="glm.html"><a href="glm.html#preparation-1"><i class="fa fa-check"></i><b>12.1</b> Preparation</a></li>
<li class="chapter" data-level="12.2" data-path="glm.html"><a href="glm.html#introduction-3"><i class="fa fa-check"></i><b>12.2</b> Introduction</a></li>
<li class="chapter" data-level="12.3" data-path="glm.html"><a href="glm.html#poisson-glm"><i class="fa fa-check"></i><b>12.3</b> Poisson GLM</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="glm.html"><a href="glm.html#model-specification"><i class="fa fa-check"></i><b>12.3.1</b> Model specification</a></li>
<li class="chapter" data-level="12.3.2" data-path="glm.html"><a href="glm.html#analysis-of-glm-data-and-interpretation"><i class="fa fa-check"></i><b>12.3.2</b> Analysis of GLM data and interpretation</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="glm.html"><a href="glm.html#binomial-glm"><i class="fa fa-check"></i><b>12.4</b> Binomial GLM</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="glm.html"><a href="glm.html#analysing-a-binomial-glm"><i class="fa fa-check"></i><b>12.4.1</b> Analysing a binomial GLM</a></li>
<li class="chapter" data-level="12.4.2" data-path="glm.html"><a href="glm.html#interpretation-of-the-estimates"><i class="fa fa-check"></i><b>12.4.2</b> Interpretation of the estimates</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="glm.html"><a href="glm.html#exercises-choose-the-probability-distribution"><i class="fa fa-check"></i><b>12.5</b> Exercises: Choose the Probability Distribution</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">General Research Skills</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anova" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> ANOVA<a href="anova.html#anova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><small><i>Analysis of variance (ANOVA) is a model for <b>comparing any number of group means</b>. The observations are assumed to be <b>independent</b>, deviations from the group means are assumed to follow a <b>normal distribution</b>, and group <b>variances are assumed to be equal</b>.</i></small></p>
<hr />
<div id="overview" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Overview<a href="anova.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Watch part 1 of the ANOVA lecture and answer the questions below.</p>
<iframe src="https://www.youtube.com/embed/BFB4o4uBgPs" width="672" height="400px" data-external="1">
</iframe>
<div id="summary-of-the-example-in-the-video" class="section level3 unnumbered hasAnchor">
<h3>Summary of the example in the video<a href="anova.html#summary-of-the-example-in-the-video" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is a summary if you want to reproduce the example analysis:</p>
<p>1. Enter the data:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="anova.html#cb8-1" aria-hidden="true" tabindex="-1"></a>SBP       <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">121</span>, <span class="dv">122</span>, <span class="dv">114</span>, <span class="dv">124</span>, <span class="dv">118</span>, <span class="dv">127</span>, <span class="co"># thiazide</span></span>
<span id="cb8-2"><a href="anova.html#cb8-2" aria-hidden="true" tabindex="-1"></a>               <span class="dv">126</span>, <span class="dv">128</span>, <span class="dv">118</span>, <span class="dv">130</span>, <span class="dv">132</span>, <span class="dv">124</span>, <span class="co"># calcium channel blockers</span></span>
<span id="cb8-3"><a href="anova.html#cb8-3" aria-hidden="true" tabindex="-1"></a>               <span class="dv">145</span>, <span class="dv">145</span>, <span class="dv">139</span>, <span class="dv">133</span>, <span class="dv">146</span>, <span class="dv">150</span>) <span class="co"># placebo</span></span>
<span id="cb8-4"><a href="anova.html#cb8-4" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">k =</span> <span class="dv">6</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;thiazide&quot;</span>, <span class="st">&quot;CCB&quot;</span>, <span class="st">&quot;placebo&quot;</span>))</span>
<span id="cb8-5"><a href="anova.html#cb8-5" aria-hidden="true" tabindex="-1"></a>DF        <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(treatment, SBP)</span></code></pre></div>
<p>2. Plot the data:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="anova.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SBP <span class="sc">~</span> treatment, <span class="at">data =</span> DF)</span></code></pre></div>
<p>3. Fit an ANOVA:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="anova.html#cb10-1" aria-hidden="true" tabindex="-1"></a>ANOVA <span class="ot">&lt;-</span> <span class="fu">aov</span>(SBP <span class="sc">~</span> treatment)</span></code></pre></div>
<p>4. Perform visual diagnostics:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="anova.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;car&quot;</span>)            <span class="co"># Install if missing</span></span>
<span id="cb11-2"><a href="anova.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))      <span class="co"># Plot in a 2x2 grid</span></span>
<span id="cb11-3"><a href="anova.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ANOVA, <span class="at">which =</span> <span class="dv">1</span>)    <span class="co"># Residuals vs fitted</span></span>
<span id="cb11-4"><a href="anova.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(ANOVA, <span class="at">reps =</span> <span class="fl">1e4</span>) <span class="co"># QQ-plot. See footnote for errors</span></span>
<span id="cb11-5"><a href="anova.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ANOVA, <span class="at">which =</span> <span class="dv">3</span>)    <span class="co"># Scale-location</span></span>
<span id="cb11-6"><a href="anova.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ANOVA, <span class="at">which =</span> <span class="dv">4</span>)    <span class="co"># Cook&#39;s distance</span></span>
<span id="cb11-7"><a href="anova.html#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))      <span class="co"># Restore the default</span></span></code></pre></div>
<p>5. Check the omnibus test:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="anova.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ANOVA)</span></code></pre></div>
<p>6. If the omnibus test is significant, you can perform a post hoc analysis:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="anova.html#cb13-1" aria-hidden="true" tabindex="-1"></a>posthoc <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(ANOVA)</span>
<span id="cb13-2"><a href="anova.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(posthoc)</span>
<span id="cb13-3"><a href="anova.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(posthoc)</span></code></pre></div>
</div>
<div id="exercises-6" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Exercises<a href="anova.html#exercises-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="figures/PlantGrowth.png" width="100%" /></p>
<ol style="list-style-type: decimal">
<li>The <code>PlantGrowth</code> data set is included with the default installation of R. It contains <span class="math inline">\(30\)</span> independent measurements of dry weight from plants subjected to three types of treatment. You can view it by running <code>View(PlantGrowth)</code> in the console, or you can see the structure of the data and produce a summary of the data like this:</li>
</ol>
<p><small></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="anova.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(PlantGrowth)</span>
<span id="cb14-2"><a href="anova.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(PlantGrowth)</span></code></pre></div>
<p></small></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Make a plot showing the weight of the different groups. You can use the same kind of plot as <a href="https://youtu.be/BFB4o4uBgPs?t=132">shown in the video</a>.</p></li>
<li><p>Fit an ANOVA and save it as an object called <code>ANOVA</code>.</p></li>
<li><p>Here is the code I used in the video to perform visual diagnostics. Run it and comment on the plots.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p></li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="anova.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;car&quot;</span>)            <span class="co"># Install if missing</span></span>
<span id="cb15-2"><a href="anova.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))      <span class="co"># Plot in a 2x2 grid</span></span>
<span id="cb15-3"><a href="anova.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ANOVA, <span class="at">which =</span> <span class="dv">1</span>)    <span class="co"># Residuals vs fitted</span></span>
<span id="cb15-4"><a href="anova.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(ANOVA, <span class="at">reps =</span> <span class="fl">1e4</span>) <span class="co"># QQ-plot. See footnote for errors</span></span>
<span id="cb15-5"><a href="anova.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ANOVA, <span class="at">which =</span> <span class="dv">3</span>)    <span class="co"># Scale-location</span></span>
<span id="cb15-6"><a href="anova.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ANOVA, <span class="at">which =</span> <span class="dv">4</span>)    <span class="co"># Cook&#39;s distance</span></span>
<span id="cb15-7"><a href="anova.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))      <span class="co"># Restore the default</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li><p>Perform the omnibus test. Is there a difference in weight among any of the groups?</p></li>
<li><p>Perform a post hoc analysis. Which group means differ significantly?</p></li>
</ol>
<hr />
</div>
</div>
<div id="how-does-anova-work" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> How does ANOVA work?<a href="anova.html#how-does-anova-work" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Watch part 2 of the ANOVA lecture and answer the questions below.</p>
<iframe src="https://www.youtube.com/embed/87ECInQIY9k" width="672" height="400px" data-external="1">
</iframe>
<div id="exercises-7" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Exercises<a href="anova.html#exercises-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Are the following statements <b>true</b> or <b>false</b>?</li>
</ol>
<ul>
<li>The omnibus test is used to see which of <span class="math inline">\(k\)</span> group means differ;</li>
<li>The omnibus test is an <span class="math inline">\(F\)</span>-test;</li>
<li>The residual variance is smaller than the total variance in the outcome;</li>
<li>The <span class="math inline">\(p\)</span>-value is the chance of obtaining an <span class="math inline">\(F\)</span>-value at least this large if there were no differences in group means;</li>
<li>The post hoc of a one-way ANOVA must still be corrected for multiple testing.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Below is the output of an omnibus test of some data:</li>
</ol>
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
Species       2  63.21  31.606   119.3 &lt;2e-16 ***
Residuals   147  38.96   0.265                   </code></pre>
<ul>
<li>What is the number of groups?</li>
<li>What is the total sample size?</li>
<li>What does <code>Pr(&gt;F)</code> mean?</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Here is another omnibus test, but with some values omitted:</li>
</ol>
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Group        x   3488   697.5     z   0.000277 ***
Residuals   48   5745     y                       </code></pre>
<ul>
<li>What is the value of <code>x</code>?</li>
<li>What is the value of <code>y</code>?</li>
<li>What is the value of <code>z</code>?</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Why do we bother with an omnibus test, why not just use the post hoc immediately after fitting the model?</li>
</ol>
<hr />
</div>
</div>
<div id="two-way-multi-way-interaction" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Two-Way, Multi-Way &amp; Interaction<a href="anova.html#two-way-multi-way-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Watch part 3 of the ANOVA lecture and answer the questions below.</p>
<iframe src="https://www.youtube.com/embed/kNPl8Vo8Jlk" width="672" height="400px" data-external="1">
</iframe>
<div id="exercises-8" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Exercises<a href="anova.html#exercises-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In an experiment on rats, a researcher wanted to find out what the effect would be of the genotype of the biological mother and the foster mother on the growth of the rats.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> <span class="math inline">\(61\)</span> rat litters were taken from their biological mother and placed with a foster mother. See the figure below.</p>
<p><img src="General-Research-Skills_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li><p>Which is suitable here: One-way, two-way, or multi-way ANOVA?</p></li>
<li><p>Do you expect an interaction or main effects here? Explain.</p></li>
<li><p>Based on your answer to the previous question, run an appropriate ANOVA for this data set. Perform visual diagnostics, look at the <code>summary</code>, and perform a post hoc analysis. Write a short conclusion. The data set is called <code>genotype</code> and you can access it by loading the package <code>MASS</code>:</p></li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="anova.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;MASS&quot;</span>) <span class="co"># Comes preinstalled with R</span></span>
<span id="cb18-2"><a href="anova.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(genotype)</span>
<span id="cb18-3"><a href="anova.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(genotype)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>(hard) Search online for the definition of the <a href="http://www.google.com/search?q=central+limit+theorem">central limit theorem</a>. Is normality of the residuals a reasonable assumption for this study from a theoretical point of view? <small><em>(HINT: Look at the help page for the <code>genotype</code> data set and read the description of the outcome variable.)</em></small></li>
</ol>
</div>
<div id="additional-exercises" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Additional Exercises (*)<a href="anova.html#additional-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="figures/Iris.png" width="100%" /></p>
<ol style="list-style-type: decimal">
<li><p>The <code>iris</code> data set is included with the default installation of R. It contains <span class="math inline">\(150\)</span> independent measurements of sepal and petal dimensions from three types of <em>Iris</em> species. Choose one of: <code>Sepal.Length</code>, <code>Petal.Length</code>, <code>Sepal.Width</code> and <code>Petal.Width</code> and perform a complete analysis to find out whether species differ on average.</p></li>
<li><p>In this exercise we are going to calculate how much variance your ANOVA from the previous exercise has explained. Remember the animation from the video:</p></li>
</ol>
<p><img src="figures/ANOVA.gif" /><!-- --></p>
<ul>
<li>Estimate the total variance in the outcome using <code>var()</code>;</li>
<li>Estimate the residual variance. You can obtain the residuals of a model using <code>residuals()</code> on the fitted model;</li>
<li>The variance explained is one minus the proportion of the total variance that remains after fitting the model. How much variance did your model explain?</li>
<li>If your model is called <code>ANOVA</code>, then you can check your answer as follows: <code>summary(lm(ANOVA))$r.squared</code>. Did you get the calculation right? This value will be explained again in the linear regression lectures.</li>
</ul>
</div>
</div>
<div id="where-is-part-4" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Where is part 4? (*)<a href="anova.html#where-is-part-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When you use two- or multi-way ANOVA, Tukey’s Honest Significant Difference only corrects for the categories <em>within</em> each explanatory variable. This quickly becomes problematic: If you’ll recall from the multiple testing lecture, with <span class="math inline">\(\alpha = 0.05\)</span>, with as little as three explanatory variables, you will already have a chance of <span class="math inline">\(1 - (1 - 0.05)^3 \approx 14.3\%\)</span> chance of at least one false positive among all comparisons.</p>
<p>In order to correct for this, you would need to somehow obtain uncorrected <span class="math inline">\(p\)</span>-values from <code>TukeyHSD</code> and then perform multiple testing correction for the total number of comparisons. This is unfortunately not very easy to do, so <b>Dr. van Mil and I decided that it would not be part of the GRS course</b>.</p>
<p>We will include this in the Advanced Statistics course for master students. If you are interested, or need this for your internship, please have a look at the <a href="https://cran.r-project.org/web/packages/emmeans/index.html">vignettes of the <code>emmeans</code> package</a>, or wait for me to release part 4 after the course. What a vignette is, is covered in the <a href="https://youtu.be/nTvdC91EyDI?t=120">video on help files</a>.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p><small><b>List of problems and how to fix them</b>: (1) If you get an error about a <b>missing package</b>, install <code>car</code> using <code>install.packages("car")</code>, then run diagnostic plots code again. (2) If you <b>can’t install <code>car</code></b>, replace <code>qqPlot(ANOVA, reps = 10e4)</code> with: <code>plot(ANOVA, which = 2)</code>. (3) If you get an error about <b>figure margins</b> being too small, simply enlarge your plot pane as shown <a href="https://youtu.be/eKKil5iyxLM?t=138">here</a>, then run the diagnostic plots code again.</small><a href="anova.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><small>Bailey, D. W. (1953): <em>The Inheritance of Maternal Influences on the Growth of the Rat.</em> Unpublished Ph.D. thesis, University of California. Table B of the Appendix.</small><a href="anova.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="study-design.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simple-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["General Research Skills.pdf", "General Research Skills.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
